(function(){var e,t,a,n,r,i;e=function(){for(var e="pixel-point/show",i=[["ids",""]],s=document.getElementsByClassName("area-ad"),d=0;d<s.length;d++)""===i[0][1]?i[0][1]+=a(s[d]).id:i[0][1]+=","+a(s[d]).id;if(i[0][1].length>0){var o=n({url:e,data:i,isResponse:!0});o.onreadystatechange=function(){if(4===this.readyState){var a={message:"",error:!0,adsIds:[],ads:[]};try{a=JSON.parse(this.response)}catch(e){}if(this.status>=500)setTimeout(function(){n({url:e,data:a,isResponse:!0})},5e3);else if(200===this.status){for(var i=[],s=[],d=0;d<a.ads.length;d++)t(a.ads[d])&&(s.push(a.ads[d].placeID)&&i.push(a.ads[d].id));r(s,i)}}},o.send(o.mybody)}},t=function(e){var t=e.id||"",a=e.href||"",n=e.placeID||"",r=e.data||"",s=document.querySelector("ins[data-area-ad-client='"+n+"']");if(!s)return null;s.addEventListener("click",i,!1),s.setAttribute("data-area-ad-id",t);var d=document.createElement("a");return d.href=a,d.innerHTML=r,s.innerHTML=d.outerHTML,t},a=function(e){return{id:e.getAttribute("data-area-ad-client")}},n=function(e){for(var t="http://icexch.media/api/v1/"+e.url,a=e.type||"POST",r=e.data,i=e.isResponse,s=new XMLHttpRequest,d="",o=0;o<r.length;o++)d+="&"+r[o][0]+"="+encodeURIComponent(r[o][1]);if(s.mybody=d,s.open(a,t,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i)return s;s.onreadystatechange=function(){if(4===this.readyState){var e={message:"",error:!0};try{e=JSON.parse(this.response)}catch(e){}(this.status>=500||e.error)&&setTimeout(function(){n({url:t,type:a,data:e})},5e3)}},s.send(d)},r=function(e,t){var a=[["adsIDs",t.join(",")],["placesIDs",e.join(",")]];n({url:"pixel-point/showed",data:a})},i=function(e){e.preventDefault();var t=[["placeID",this.getAttribute("data-area-ad-client")],["adID",this.getAttribute("data-area-ad-id")]];n({url:"pixel-point/clicked",data:t})},e()}).call(this);